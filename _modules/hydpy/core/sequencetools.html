<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>hydpy.core.sequencetools &#8212; HydPy 2.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 2.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.core.sequencetools</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Tue Dec 27 23:23:53 2016</span>

<span class="sd">@author: tyralla</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1"># import...</span>
<span class="c1"># ...from standard library</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># ...from site-packages</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="c1"># ...from HydPy</span>
<span class="kn">from</span> <span class="nn">hydpy</span> <span class="k">import</span> <span class="n">pub</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">timetools</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">objecttools</span>
<span class="kn">from</span> <span class="nn">hydpy.cythons</span> <span class="k">import</span> <span class="n">pointer</span>

<div class="viewcode-block" id="Sequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences">[docs]</a><span class="k">class</span> <span class="nc">Sequences</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling all sequences of a specific model.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
        <span class="n">cythonmodule</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cythonmodule&#39;</span><span class="p">)</span>
        <span class="n">cymodel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cymodel&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;Sequences&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">SubSequences</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">cythonmodule</span><span class="p">:</span>
                    <span class="n">cls_fastaccess</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">cythonmodule</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                    <span class="n">subseqs</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">subseqs</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span>

<div class="viewcode-block" id="Sequences.set_initvals"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.set_initvals">[docs]</a>    <span class="k">def</span> <span class="nf">set_initvals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="p">,</span> <span class="n">idx_date</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="o">.</span><span class="n">set_initvals</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">idx_date</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;activate_disk&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.deactivate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.deactivate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;deactivate_disk&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">deactivate_disk</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;activate_ram&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.deactivate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.deactivate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;deactivate_ram&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">deactivate_ram</span><span class="p">(</span><span class="n">names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.openfiles"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.openfiles">[docs]</a>    <span class="k">def</span> <span class="nf">openfiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;openfiles&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">openfiles</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.closefiles"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.closefiles">[docs]</a>    <span class="k">def</span> <span class="nf">closefiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;closefiles&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">closefiles</span><span class="p">()</span></div>

<div class="viewcode-block" id="Sequences.loaddata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.loaddata">[docs]</a>    <span class="k">def</span> <span class="nf">loaddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;loaddata&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">loaddata</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.savedata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.savedata">[docs]</a>    <span class="k">def</span> <span class="nf">savedata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;savedata&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">savedata</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.reset"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="s1">&#39;reset&#39;</span><span class="p">):</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">SubSequences</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generator object yielding all conditions (class:`StateSequence` and</span>
<span class="sd">        :class:`LogSequence` objects).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">subseqs</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;states&#39;</span><span class="p">,</span> <span class="s1">&#39;logs&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">tuple_</span> <span class="ow">in</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">,</span> <span class="p">()):</span>
                <span class="k">yield</span> <span class="n">tuple_</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hasconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;True or False, whether the :class:`Sequences` object handles at</span>
<span class="sd">        conditions (at least one :class:`StateSequence` or :class:`LogSequence`</span>
<span class="sd">        object)  or not.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">tuple_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_conditiondefaultfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;?&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s1">&#39;To load or save the conditions of a model from or to a file, &#39;</span>
                <span class="s1">&#39;its filename must be known.  This can be done, by passing &#39;</span>
                <span class="s1">&#39;filename to function `loadconditions` or `saveconditions` &#39;</span>
                <span class="s1">&#39;directly.  But in complete HydPy applications, it is usally &#39;</span>
                <span class="s1">&#39;assumed to be consistent with the name of the element &#39;</span>
                <span class="s1">&#39;handling the model.  Actually, neither a filename is given &#39;</span>
                <span class="s1">&#39;nor does the model know its master element.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">filename</span> <span class="o">+</span> <span class="s1">&#39;.py&#39;</span>

<div class="viewcode-block" id="Sequences.loadconditions"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.loadconditions">[docs]</a>    <span class="k">def</span> <span class="nf">loadconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load initial conditions from a file and assign them to the</span>
<span class="sd">        respective sequences.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasconditions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditiondefaultfilename</span>
            <span class="n">namespace</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
                <span class="n">namespace</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
            <span class="n">namespace</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">conditionmanager</span><span class="o">.</span><span class="n">loadfile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dirname</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">exec</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="n">objecttools</span><span class="o">.</span><span class="n">augmentexcmessage</span><span class="p">(</span><span class="s1">&#39;While trying to gather initial &#39;</span>
                                              <span class="s1">&#39;conditions of element </span><span class="si">%s</span><span class="s1">&#39;</span>
                                              <span class="o">%</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="Sequences.saveconditions"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.saveconditions">[docs]</a>    <span class="k">def</span> <span class="nf">saveconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dirname</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hasconditions</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conditiondefaultfilename</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.py&#39;</span><span class="p">):</span>
                <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;.py&#39;</span>
            <span class="k">if</span> <span class="n">dirname</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dirname</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">conditionmanager</span><span class="o">.</span><span class="n">savepath</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">file</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;from hydpy.models.</span><span class="si">%s</span><span class="s1"> import *</span><span class="se">\n\n</span><span class="s1">&#39;</span>
                            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;controlcheck(projectdir=&quot;</span><span class="si">%s</span><span class="s1">&quot;, controldir=&quot;</span><span class="si">%s</span><span class="s1">&quot;)&#39;</span>
                            <span class="o">%</span> <span class="p">(</span><span class="n">pub</span><span class="o">.</span><span class="n">controlmanager</span><span class="o">.</span><span class="n">projectdirectory</span><span class="p">,</span>
                               <span class="n">pub</span><span class="o">.</span><span class="n">controlmanager</span><span class="o">.</span><span class="n">controldirectory</span><span class="p">))</span>
                    <span class="n">file_</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
                    <span class="n">file_</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequences.trimconditions"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequences.trimconditions">[docs]</a>    <span class="k">def</span> <span class="nf">trimconditions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conditions</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">trim</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="SubSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.SubSequences">[docs]</a><span class="k">class</span> <span class="nc">SubSequences</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling subgroups of sequences.</span>

<span class="sd">    Attributes:</span>
<span class="sd">      * seqs: The parent :class:`Sequences` object.</span>
<span class="sd">      * fastaccess: The  :class:`FastAccess` object allowing fast access to</span>
<span class="sd">        the sequence values. In `Cython` mode, model specific cdef</span>
<span class="sd">        classes are applied.</span>

<span class="sd">    Additional attributes are the actual :class:`Sequence` instances,</span>
<span class="sd">    representing the individual time series.  These need to be defined in</span>
<span class="sd">    :class:`SubSequences` subclass.  Therefore, one needs to collect the</span>
<span class="sd">    appropriate :class:`Sequence` subclasses in the (hidden) class attribute</span>
<span class="sd">    :attr:`~SubSequences._SEQCLASSES`, as shown in the following example:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy.core.sequencetools import *</span>
<span class="sd">    &gt;&gt;&gt; class Temperature(Sequence):</span>
<span class="sd">    ...    NDIM, NUMERIC = 0, False</span>
<span class="sd">    &gt;&gt;&gt; class Precipitation(Sequence):</span>
<span class="sd">    ...    NDIM, NUMERIC = 0, True</span>
<span class="sd">    &gt;&gt;&gt; class InputSequences(SubSequences):</span>
<span class="sd">    ...     _SEQCLASSES = (Temperature, Precipitation)</span>
<span class="sd">    &gt;&gt;&gt; inputs = InputSequences(None) # Assign `None` for brevity.</span>
<span class="sd">    &gt;&gt;&gt; inputs</span>
<span class="sd">    temperature(0.0)</span>
<span class="sd">    precipitation(0.0)</span>

<span class="sd">    The order within the tuple determines the order of iteration, hence:</span>

<span class="sd">    &gt;&gt;&gt; for (name, sequence) in inputs:</span>
<span class="sd">    ...     print(sequence)</span>
<span class="sd">    temperature(0.0)</span>
<span class="sd">    precipitation(0.0)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqs</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cymodel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span> <span class="o">=</span> <span class="n">seqs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initfastaccess</span><span class="p">(</span><span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initsequences</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_initfastaccess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cls_fastaccess</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span> <span class="o">=</span> <span class="n">FastAccess</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span> <span class="o">=</span> <span class="n">cls_fastaccess</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cymodel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initsequences</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">cls_seq</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SEQCLASSES</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">instancename</span><span class="p">(</span><span class="n">cls_seq</span><span class="p">),</span> <span class="n">cls_seq</span><span class="p">())</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="SubSequences.getname"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.SubSequences.getname">[docs]</a>    <span class="k">def</span> <span class="nf">getname</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">instancename</span><span class="p">(</span><span class="bp">cls</span><span class="p">)[:</span><span class="o">-</span><span class="mi">8</span><span class="p">]</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getname</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Attributes and methods should usually not be replaced.  Existing</span>
<span class="sd">        :class:`Sequence` attributes are protected in a way, that only their</span>
<span class="sd">        values are changed through assignements.  For new :class:`Sequence`</span>
<span class="sd">        attributes, additional `fastaccess` references are defined.  If you</span>
<span class="sd">        actually want to replace a sequence, you have to delete it first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">):</span>
                <span class="n">value</span><span class="o">.</span><span class="n">connect2subseqs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">attr</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;`</span><span class="si">%s</span><span class="s1">` instances do not allow the direct&#39;</span>
                                   <span class="s1">&#39;replacement of their members.  After &#39;</span>
                                   <span class="s1">&#39;initialization you should usually only &#39;</span>
                                   <span class="s1">&#39;change parameter values through &#39;</span>
                                   <span class="s1">&#39;assignements.  If you really need to &#39;</span>
                                   <span class="s1">&#39;replace a object member, delete it &#39;</span>
                                   <span class="s1">&#39;beforehand.&#39;</span> <span class="o">%</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">seqclass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_SEQCLASSES</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">instancename</span><span class="p">(</span><span class="n">seqclass</span><span class="p">)</span>
            <span class="k">yield</span> <span class="n">name</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">reprcomments</span><span class="p">:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#</span><span class="si">%s</span><span class="s1"> object defined in module </span><span class="si">%s</span><span class="s1">.&#39;</span>
                         <span class="o">%</span> <span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                            <span class="n">objecttools</span><span class="o">.</span><span class="n">modulename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;#The implemented sequences with their actual &#39;</span>
                         <span class="s1">&#39;values are:&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">sequence</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(?)&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">dir_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="IOSubSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences">[docs]</a><span class="k">class</span> <span class="nc">IOSubSequences</span><span class="p">(</span><span class="n">SubSequences</span><span class="p">):</span>

<div class="viewcode-block" id="IOSubSequences.openfiles"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences.openfiles">[docs]</a>    <span class="k">def</span> <span class="nf">openfiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">openfiles</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="IOSubSequences.closefiles"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences.closefiles">[docs]</a>    <span class="k">def</span> <span class="nf">closefiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">closefiles</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSubSequences.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSubSequences.deactivate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences.deactivate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">deactivate_ram</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSubSequences.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSubSequences.deactivate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences.deactivate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">deactivate_disk</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSubSequences.ram2disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences.ram2disk">[docs]</a>    <span class="k">def</span> <span class="nf">ram2disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">ram2disk</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSubSequences.disk2ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSubSequences.disk2ram">[docs]</a>    <span class="k">def</span> <span class="nf">disk2ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">disk2ram</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="InputSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.InputSequences">[docs]</a><span class="k">class</span> <span class="nc">InputSequences</span><span class="p">(</span><span class="n">IOSubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling input sequences.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="InputSequences.loaddata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.InputSequences.loaddata">[docs]</a>    <span class="k">def</span> <span class="nf">loaddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">loaddata</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="FluxSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FluxSequences">[docs]</a><span class="k">class</span> <span class="nc">FluxSequences</span><span class="p">(</span><span class="n">IOSubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling flux sequences.&quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="FluxSequences.getname"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FluxSequences.getname">[docs]</a>    <span class="k">def</span> <span class="nf">getname</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;fluxes&#39;</span></div>

<div class="viewcode-block" id="FluxSequences.savedata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FluxSequences.savedata">[docs]</a>    <span class="k">def</span> <span class="nf">savedata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">savedata</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="StateSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequences">[docs]</a><span class="k">class</span> <span class="nc">StateSequences</span><span class="p">(</span><span class="n">IOSubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling state sequences.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_initfastaccess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">):</span>
        <span class="n">SubSequences</span><span class="o">.</span><span class="n">_initfastaccess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">,</span> <span class="n">cymodel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="k">if</span> <span class="n">cls_fastaccess</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span> <span class="o">=</span> <span class="n">FastAccess</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cymodel</span><span class="p">,</span> <span class="s1">&#39;new_states&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span> <span class="o">=</span> <span class="n">cls_fastaccess</span><span class="p">()</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cymodel</span><span class="p">,</span> <span class="s1">&#39;old_states&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">)</span>

<div class="viewcode-block" id="StateSequences.new2old"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequences.new2old">[docs]</a>    <span class="k">def</span> <span class="nf">new2old</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign the new/final state values of the actual time step to the</span>
<span class="sd">        new/initial state values of the next time step.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">new2old</span><span class="p">()</span></div>

<div class="viewcode-block" id="StateSequences.savedata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequences.savedata">[docs]</a>    <span class="k">def</span> <span class="nf">savedata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">savedata</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="StateSequences.reset"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequences.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="LogSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LogSequences">[docs]</a><span class="k">class</span> <span class="nc">LogSequences</span><span class="p">(</span><span class="n">SubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling log sequences.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="LogSequences.reset"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LogSequences.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="AideSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.AideSequences">[docs]</a><span class="k">class</span> <span class="nc">AideSequences</span><span class="p">(</span><span class="n">SubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling aide sequences.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="LinkSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LinkSequences">[docs]</a><span class="k">class</span> <span class="nc">LinkSequences</span><span class="p">(</span><span class="n">SubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling link sequences.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Sequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequence">[docs]</a><span class="k">class</span> <span class="nc">Sequence</span><span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">ValueMath</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Only for inheritance.&quot;&quot;&quot;</span>

    <span class="n">NDIM</span><span class="p">,</span> <span class="n">NUMERIC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Sequence.connect2subseqs"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sequence.connect2subseqs">[docs]</a>    <span class="k">def</span> <span class="nf">connect2subseqs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span> <span class="o">=</span> <span class="n">subseqs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span> <span class="o">=</span> <span class="n">subseqs</span><span class="o">.</span><span class="n">fastaccess</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ndim&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initvalues</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The prefered way to pass values to :class:`Sequence` instances</span>
<span class="sd">        within initial condition files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Name of the sequence, which is the name if the instantiating</span>
<span class="sd">        subclass of :class:`Sequence` in lower case letters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getname</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The actual time series value(s) handled by the respective</span>
<span class="sd">        :class:`Sequence` instance.  For consistency, `value` and `values`</span>
<span class="sd">        can always be used interchangeably.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;No value/values of sequence </span><span class="si">%s</span><span class="s1"> of element &#39;</span>
                               <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> has/have been defined so far.&#39;</span>
                               <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
    <span class="k">def</span> <span class="nf">_setvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> values are assigned to the scalar &#39;</span>
                                     <span class="s1">&#39;sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1">, which is &#39;</span>
                                     <span class="s1">&#39;ambiguous.&#39;</span>
                                     <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
                                        <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                                        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">temp</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;When trying to set the value of sequence &#39;</span>
                                <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1">, it was not possible to &#39;</span>
                                <span class="s1">&#39;convert value `</span><span class="si">%s</span><span class="s1">` to float .&#39;</span>
                                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                                   <span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;For sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> setting new &#39;</span>
                                 <span class="s1">&#39;values failed.  The values `</span><span class="si">%s</span><span class="s1">` cannot be &#39;</span>
                                 <span class="s1">&#39;converted to a numpy ndarray with shape </span><span class="si">%s</span><span class="s1"> &#39;</span>
                                 <span class="s1">&#39;containing entries of type float.&#39;</span>
                                 <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                                    <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getvalue</span><span class="p">,</span> <span class="n">_setvalue</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_getshape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A tuple containing the lengths in all dimensions of the sequence</span>
<span class="sd">        values at a specific time point.  Note that setting a new shape</span>
<span class="sd">        results in a loss of the actual values of the respective sequence.</span>
<span class="sd">        For 0-dimensional sequences :attr:`shape` is always an empty tuple.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Shape information for sequence </span><span class="si">%s</span><span class="s1"> of &#39;</span>
                                   <span class="s1">&#39;element </span><span class="si">%s</span><span class="s1"> can only be retrieved after &#39;</span>
                                   <span class="s1">&#39;it has been defined.&#39;</span>
                                   <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                      <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>
    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">array</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;While trying create a new numpy ndarray` for &#39;</span>
                          <span class="s1">&#39;sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1">&#39;</span>
                          <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
                <span class="n">objecttools</span><span class="o">.</span><span class="n">augmentexcmessage</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">array</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> is </span><span class="si">%d</span><span class="s1">-dimensional &#39;</span>
                                 <span class="s1">&#39;but the given shape indicates </span><span class="si">%d</span><span class="s1"> dimensions.&#39;</span>
                                 <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">,</span> <span class="n">array</span><span class="o">.</span><span class="n">ndim</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">shape</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The shape information of 0-dimensional &#39;</span>
                                 <span class="s1">&#39;sequences as </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> can only be &#39;</span>
                                 <span class="s1">&#39;`()`, but `</span><span class="si">%s</span><span class="s1">` is given.&#39;</span>
                                 <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                                    <span class="n">shape</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_raiseitemexception</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_raiseitemexception</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_raiseitemexception</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` has no values so far.&#39;</span>
                               <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augmentexcmessage</span><span class="p">(</span><span class="s1">&#39;While trying to item access the &#39;</span>
                                          <span class="s1">&#39;values of sequence `</span><span class="si">%s</span><span class="s1">`&#39;</span>
                                          <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">repr_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cols</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">repr_</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
            <span class="n">wrappedlines</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="mi">80</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">wrappedlines</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">line</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
            <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="s1">&#39;)&#39;</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">skip</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span> <span class="o">*</span> <span class="s1">&#39; &#39;</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
                <span class="n">cols</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">repr_</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">,&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">skip</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>
            <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;`repr` does not yet support &#39;</span>
                                      <span class="s1">&#39;sequences, which handle </span><span class="si">%d</span><span class="s1">-&#39;</span>
                                      <span class="s1">&#39;dimensional matrices.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">dir_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="IOSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence">[docs]</a><span class="k">class</span> <span class="nc">IOSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Only for inheritance.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Sequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_getfiletype_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Ending of the external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InputSequence</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">inputfiletype</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NodeSequence</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">nodefiletype</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">outputfiletype</span>

            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;For sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> the type &#39;</span>
                                   <span class="s1">&#39;of the external data file cannot be &#39;</span>
                                   <span class="s1">&#39;determined.  Either set it manually or &#39;</span>
                                   <span class="s1">&#39;embed the sequence object into the HydPy &#39;</span>
                                   <span class="s1">&#39;framework in the common manner to allow &#39;</span>
                                   <span class="s1">&#39;for an automatic determination.&#39;</span>
                                   <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                      <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>
    <span class="k">def</span> <span class="nf">_setfiletype_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">def</span> <span class="nf">_delfiletype_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filetype_ext</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">filetype_ext</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getfiletype_ext</span><span class="p">,</span> <span class="n">_setfiletype_ext</span><span class="p">,</span>
                            <span class="n">_delfiletype_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getfilename_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Complete filename of the external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">rawfilename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_ext</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">_setfilename_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">def</span> <span class="nf">_delfilename_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filename_ext</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">filename_ext</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getfilename_ext</span><span class="p">,</span> <span class="n">_setfilename_ext</span><span class="p">,</span>
                            <span class="n">_delfilename_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getfilename_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Complete filename of the internal data file.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rawfilename</span> <span class="o">+</span> <span class="s1">&#39;.bin&#39;</span>
    <span class="n">filename_int</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getfilename_int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getdirpath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute path of the directory of the external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InputSequence</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">inputpath</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NodeSequence</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">nodepath</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">outputpath</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the directory of &#39;</span>
                                   <span class="s1">&#39;the external data file cannot be &#39;</span>
                                   <span class="s1">&#39;determined.  Either set it manually or &#39;</span>
                                   <span class="s1">&#39;embed the sequence object into the HydPy &#39;</span>
                                   <span class="s1">&#39;framework in the common manner to allow &#39;</span>
                                   <span class="s1">&#39;for an automatic determination.&#39;</span>
                                   <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setdirpath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">def</span> <span class="nf">_deldirpath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_ext</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dirpath_ext</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getdirpath_ext</span><span class="p">,</span> <span class="n">_setdirpath_ext</span><span class="p">,</span> <span class="n">_deldirpath_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getdirpath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute path of the directory of the internal data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">pub</span><span class="o">.</span><span class="n">sequencemanager</span><span class="o">.</span><span class="n">temppath</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the directory of &#39;</span>
                                   <span class="s1">&#39;the internal data file cannot be &#39;</span>
                                   <span class="s1">&#39;determined.  Either set it manually or &#39;</span>
                                   <span class="s1">&#39;embed the sequence object into the HydPy &#39;</span>
                                   <span class="s1">&#39;framework in the common manner to allow &#39;</span>
                                   <span class="s1">&#39;for an automatic determination.&#39;</span>
                                   <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setdirpath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">def</span> <span class="nf">_deldirpath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dirpath_int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dirpath_int</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getdirpath_int</span><span class="p">,</span> <span class="n">_setdirpath_int</span><span class="p">,</span> <span class="n">_deldirpath_int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getfilepath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute path to the external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirpath_ext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_ext</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setfilepath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">def</span> <span class="nf">_delfilepath_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_ext</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">filepath_ext</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getfilepath_ext</span><span class="p">,</span> <span class="n">_setfilepath_ext</span><span class="p">,</span>
                            <span class="n">_delfilepath_ext</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getfilepath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Absolute path to the internal data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dirpath_int</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename_int</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setfilepath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">def</span> <span class="nf">_delfilepath_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filepath_int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">filepath_int</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getfilepath_int</span><span class="p">,</span> <span class="n">_setfilepath_int</span><span class="p">,</span>
                            <span class="n">_delfilepath_int</span><span class="p">)</span>

<div class="viewcode-block" id="IOSequence.update_fastaccess"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.update_fastaccess">[docs]</a>    <span class="k">def</span> <span class="nf">update_fastaccess</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath_int</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_path&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">):</span>
            <span class="n">length</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">idx</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_getdiskflag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">diskflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">diskflag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">diskflag</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The `diskflag` of sequence `</span><span class="si">%s</span><span class="s1">` has &#39;</span>
                               <span class="s1">&#39;not been set yet.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setdiskflag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>  <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="n">diskflag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getdiskflag</span><span class="p">,</span> <span class="n">_setdiskflag</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getramflag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ramflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ramflag&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ramflag</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ramflag</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The `ramflag` of sequence `</span><span class="si">%s</span><span class="s1">` has &#39;</span>
                               <span class="s1">&#39;not been set yet.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setramflag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ramflag&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>  <span class="nb">bool</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="n">ramflag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getramflag</span><span class="p">,</span> <span class="n">_setramflag</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getmemoryflag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span>
    <span class="n">memoryflag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getmemoryflag</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getarray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">array</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;The `ram array` of sequence `</span><span class="si">%s</span><span class="s1">` has &#39;</span>
                               <span class="s1">&#39;not been set yet.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>  <span class="n">values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getseriesshape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shape of the whole time series (time beeing the first dimension).&quot;&quot;&quot;</span>
        <span class="n">seriesshape</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)]</span>
        <span class="n">seriesshape</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">seriesshape</span><span class="p">)</span>
    <span class="n">seriesshape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getseriesshape</span><span class="p">)</span>

<span class="c1">#    def _gettimegrid_init(self):</span>
<span class="c1">#        if self._timegrid_init is not None:</span>
<span class="c1">#            return self._timegrid_init</span>
<span class="c1">#        else:</span>
<span class="c1">#            try:</span>
<span class="c1">#                return pub.timegrids.init</span>
<span class="c1">#            except AttributeError:</span>
<span class="c1">#                raise RuntimeError(&#39;Initializing internal data of sequence &#39;</span>
<span class="c1">#                                   &#39;`%s` requires information about the &#39;</span>
<span class="c1">#                                   &#39;initialization period.  Define an &#39;</span>
<span class="c1">#                                   &#39;appropriate `Timegrid` instance and &#39;</span>
<span class="c1">#                                   &#39;either pass it to the sequence object &#39;</span>
<span class="c1">#                                   &#39;or store it in the `pub` module as &#39;</span>
<span class="c1">#                                   &#39;described in the documentation.&#39;</span>
<span class="c1">#                                   % self.name)</span>
<span class="c1">#    def _settimegrid_init(self, timegrid):</span>
<span class="c1">#        self._timegrid_init = timegrid</span>
<span class="c1">#    timegrid_init = property(_gettimegrid_init, _settimegrid_init)</span>

    <span class="k">def</span> <span class="nf">_getseries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_int</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getarray</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` is not requested to make any &#39;</span>
                               <span class="s1">&#39;internal data available to the user.&#39;</span>
                               <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
        <span class="n">series</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_int</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setarray</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` is not requested to make any &#39;</span>
                               <span class="s1">&#39;internal data available to the user.&#39;</span>
                               <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_delseries</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_int</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">series</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getseries</span><span class="p">,</span> <span class="n">_setseries</span><span class="p">,</span> <span class="n">_delseries</span><span class="p">)</span>

<div class="viewcode-block" id="IOSequence.load_ext"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.load_ext">[docs]</a>    <span class="k">def</span> <span class="nf">load_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load the external data series in accordance with</span>
<span class="sd">        :attr:`~IOSequence.timegrid_init` and store it as internal data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_ext</span> <span class="o">==</span> <span class="s1">&#39;npy&#39;</span><span class="p">:</span>
            <span class="n">timegrid_data</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_npy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">timegrid_data</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_asc</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">timegrid_data</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the initialization time &#39;</span>
                               <span class="s1">&#39;grid (</span><span class="si">%s</span><span class="s1">) does not define a subset of the &#39;</span>
                               <span class="s1">&#39;time grid of the external data file </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">).&#39;</span>
                               <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="n">timegrid_data</span><span class="p">))</span>
        <span class="n">idx1</span> <span class="o">=</span> <span class="n">timegrid_data</span><span class="p">[</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">firstdate</span><span class="p">]</span>
        <span class="n">idx2</span> <span class="o">=</span> <span class="n">timegrid_data</span><span class="p">[</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">lastdate</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_int</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setarray</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` is not requested to make any &#39;</span>
                               <span class="s1">&#39;internal data available the the user.&#39;</span>
                               <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="IOSequence.save_ext"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.save_ext">[docs]</a>    <span class="k">def</span> <span class="nf">save_ext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Write the internal data into an external data file.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype_ext</span> <span class="o">==</span> <span class="s1">&#39;npy&#39;</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">):</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">values</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">))</span>
            <span class="n">numpy</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">numpy</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">file_</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_load_npy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the data timegrid and the complete external data from a</span>
<span class="sd">        binary numpy file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;While trying to load the external data of sequence &#39;</span>
                      <span class="s1">&#39;`</span><span class="si">%s</span><span class="s1">` from file `</span><span class="si">%s</span><span class="s1">`&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">))</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augmentexcmessage</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">timegrid_data</span> <span class="o">=</span> <span class="n">timetools</span><span class="o">.</span><span class="n">Timegrid</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;While trying to retrieve the data timegrid of the &#39;</span>
                      <span class="s1">&#39;external data file `</span><span class="si">%s</span><span class="s1">` of sequence `</span><span class="si">%s</span><span class="s1">`&#39;</span>
                      <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augmentexcmessage</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timegrid_data</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">13</span><span class="p">:]</span>

    <span class="k">def</span> <span class="nf">_load_asc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">)</span> <span class="k">as</span> <span class="n">file_</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">file_</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
        <span class="n">timegrid_data</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{</span><span class="s1">&#39;Timegrid&#39;</span><span class="p">:</span> <span class="n">timetools</span><span class="o">.</span><span class="n">Timegrid</span><span class="p">})</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_ext</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                               <span class="n">ndmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timegrid_data</span><span class="p">,</span> <span class="n">values</span>

    <span class="k">def</span> <span class="nf">_load_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load internal data from file and return it.&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_int</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seriesshape</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">values</span>

<div class="viewcode-block" id="IOSequence.zero_int"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.zero_int">[docs]</a>    <span class="k">def</span> <span class="nf">zero_int</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the internal data series with zero values.&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seriesshape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_save_int</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_setarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Sequence `</span><span class="si">%s</span><span class="s1">` is not requested to make any &#39;</span>
                               <span class="s1">&#39;internal data available to the user.&#39;</span>
                               <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_save_int</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">values</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepath_int</span><span class="p">)</span>

<div class="viewcode-block" id="IOSequence.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Demand reading/writing internal data from/to hard disk.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deactivate_ram</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InputSequence</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NodeSequence</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ext</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_ext</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zero_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequence.deactivate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.deactivate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prevent from reading/writing internal data from/to hard disk.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="IOSequence.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Demand reading/writing internal data from/to hard disk.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deactivate_disk</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">InputSequence</span><span class="p">)</span> <span class="ow">or</span>
            <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">NodeSequence</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_ext</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_ext</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zero_int</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequence.deactivate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.deactivate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">deactivate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Prevent from reading/writing internal data from/to hard disk.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="IOSequence.disk2ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.disk2ram">[docs]</a>    <span class="k">def</span> <span class="nf">disk2ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move internal data from disk to RAM.&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deactivate_disk</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span></div>

<div class="viewcode-block" id="IOSequence.ram2disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.IOSequence.ram2disk">[docs]</a>    <span class="k">def</span> <span class="nf">ram2disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Move internal data from RAM to disk.&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deactivate_ram</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_int</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="n">Sequence</span><span class="o">.</span><span class="n">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_fastaccess</span><span class="p">()</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">Sequence</span><span class="o">.</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span></div>


<div class="viewcode-block" id="ModelIOSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ModelIOSequence">[docs]</a><span class="k">class</span> <span class="nc">ModelIOSequence</span><span class="p">(</span><span class="n">IOSequence</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_getrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filename without ending for external and internal date files.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="o">.</span><span class="n">seqs</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                       <span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="p">)[:</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the raw filename cannot &#39;</span>
                                   <span class="s1">&#39;determined.  Either set it manually or &#39;</span>
                                   <span class="s1">&#39;embed the sequence object into the HydPy &#39;</span>
                                   <span class="s1">&#39;framework in the common manner to allow &#39;</span>
                                   <span class="s1">&#39;for an automatic determination.&#39;</span>
                                   <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_delrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rawfilename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getrawfilename</span><span class="p">,</span> <span class="n">_setrawfilename</span><span class="p">,</span> <span class="n">_delrawfilename</span><span class="p">)</span></div>

<div class="viewcode-block" id="InputSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.InputSequence">[docs]</a><span class="k">class</span> <span class="nc">InputSequence</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="FluxSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FluxSequence">[docs]</a><span class="k">class</span> <span class="nc">FluxSequence</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="ConditionSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ConditionSequence">[docs]</a><span class="k">class</span> <span class="nc">ConditionSequence</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
    
<div class="viewcode-block" id="ConditionSequence.trim"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ConditionSequence.trim">[docs]</a>    <span class="k">def</span> <span class="nf">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">objecttools</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="ConditionSequence.warntrim"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ConditionSequence.warntrim">[docs]</a>    <span class="k">def</span> <span class="nf">warntrim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;For sequence </span><span class="si">%s</span><span class="s1"> of element </span><span class="si">%s</span><span class="s1"> at least one value &#39;</span>
                      <span class="s1">&#39;needed to be trimmed.  One possible reason could be &#39;</span>
                      <span class="s1">&#39;that the related control parameter and initial &#39;</span>
                      <span class="s1">&#39;condition files are inconsistent.&#39;</span>
                      <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">devicename</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span></div>

<div class="viewcode-block" id="ConditionSequence.reset"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.ConditionSequence.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="StateSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequence">[docs]</a><span class="k">class</span> <span class="nc">StateSequence</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="p">,</span> <span class="n">ConditionSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Handler for state time series.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_new</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The prefered way to pass values to :class:`Sequence` instances</span>
<span class="sd">        within initial condition files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ConditionSequence</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new2old</span><span class="p">()</span>

<div class="viewcode-block" id="StateSequence.connect2subseqs"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequence.connect2subseqs">[docs]</a>    <span class="k">def</span> <span class="nf">connect2subseqs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">connect2subseqs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span> <span class="o">=</span> <span class="n">subseqs</span><span class="o">.</span><span class="n">fastaccess_old</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_new</span> <span class="o">=</span> <span class="n">subseqs</span><span class="o">.</span><span class="n">fastaccess_new</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">ModelIOSequence</span><span class="o">.</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span>

    <span class="n">new</span> <span class="o">=</span> <span class="n">Sequence</span><span class="o">.</span><span class="n">values</span>
    <span class="sd">&quot;&quot;&quot;Complete access to the state value(s), which will be used in the next</span>
<span class="sd">    calculation steps.  Note that :attr:`~StateSequence.new` is a synonym of</span>
<span class="sd">    :attr:`~StateSequence.value`.  Use this property to modify the initial</span>
<span class="sd">    condition(s) of a single :class:`StateSequence` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_getold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assess to the state value(s) at beginning of the time step, which</span>
<span class="sd">        has been processed most recently.  When using :ref:`HydPy` in the</span>
<span class="sd">        normal manner.  But it can be helpful for demonstration and debugging</span>
<span class="sd">        purposes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;No value/values of sequence `</span><span class="si">%s</span><span class="s1">` has/have &#39;</span>
                               <span class="s1">&#39;not been defined so far.&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
    <span class="k">def</span> <span class="nf">_setold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1"> values are assigned to the scalar &#39;</span>
                                     <span class="s1">&#39;sequence `</span><span class="si">%s</span><span class="s1">`, which is ambiguous.&#39;</span>
                                     <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">temp</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;When trying to set the value of sequence &#39;</span>
                                <span class="s1">&#39;`</span><span class="si">%s</span><span class="s1">`, it was not possible to convert `</span><span class="si">%s</span><span class="s1">` &#39;</span>
                                <span class="s1">&#39;to float .&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;The values `</span><span class="si">%s</span><span class="s1">` cannot be converted to a &#39;</span>
                                 <span class="s1">&#39;numpy ndarray with shape </span><span class="si">%s</span><span class="s1"> containing &#39;</span>
                                 <span class="s1">&#39;entries of type float.&#39;</span>
                                 <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess_old</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">old</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getold</span><span class="p">,</span> <span class="n">_setold</span><span class="p">)</span>

<div class="viewcode-block" id="StateSequence.new2old"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.StateSequence.new2old">[docs]</a>    <span class="k">def</span> <span class="nf">new2old</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">old</span><span class="p">[:]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">[:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span></div></div>


<div class="viewcode-block" id="LogSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LogSequence">[docs]</a><span class="k">class</span> <span class="nc">LogSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">,</span> <span class="n">ConditionSequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Sequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trim</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_oldargs</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>


<div class="viewcode-block" id="AideSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.AideSequence">[docs]</a><span class="k">class</span> <span class="nc">AideSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="LinkSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LinkSequence">[docs]</a><span class="k">class</span> <span class="nc">LinkSequence</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;2&quot;&quot;&quot;</span>

<div class="viewcode-block" id="LinkSequence.setpointer"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.LinkSequence.setpointer">[docs]</a>    <span class="k">def</span> <span class="nf">setpointer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">pdouble</span> <span class="o">=</span> <span class="n">pointer</span><span class="o">.</span><span class="n">PDouble</span><span class="p">(</span><span class="n">double</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">setpointer0d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pdouble</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pdouble</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">setpointer1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pdouble</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">ppdouble</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">ppdouble</span><span class="o">.</span><span class="n">setpointer</span><span class="p">(</span><span class="n">double</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pointer</span><span class="o">.</span><span class="n">PPDouble</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

<span class="c1">#    def _getvalue(self):</span>
<span class="c1">#        &quot;&quot;&quot;Actual value(s) handled by the sequence.  For consistency,</span>
<span class="c1">#        `value` and `values` can always be used interchangeably.&quot;&quot;&quot;</span>
<span class="c1">#        try:</span>
<span class="c1">#            return getattr(self.fastaccess, self.name)</span>
<span class="c1">#        except AttributeError:</span>
<span class="c1">#            if self.NDIM == 0:</span>
<span class="c1">#                return self.fastaccess.getpointer0d(self.name)</span>
<span class="c1">#            elif self.NDIM == 1:</span>
<span class="c1">#                return self.fastaccess.getpointer1d(self.name)</span>
    <span class="k">def</span> <span class="nf">_getvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;ToDo&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;To retrieve a pointer is very likely to &#39;</span>
                                  <span class="s1">&#39;result in bugs and is thus not supported &#39;</span>
                                  <span class="s1">&#39;at the moment.&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setvalue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Could be implemented, but is not important at the moment...&quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;To change a pointer is very likely to &#39;</span>
                                  <span class="s1">&#39;result in bugs and is thus not supported &#39;</span>
                                  <span class="s1">&#39;at the moment.&#39;</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getvalue</span><span class="p">,</span> <span class="n">_setvalue</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">_getshape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_0&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">dealloc</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getshape</span><span class="p">,</span> <span class="n">_setshape</span><span class="p">)</span></div>


<div class="viewcode-block" id="NodeSequence"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.NodeSequence">[docs]</a><span class="k">class</span> <span class="nc">NodeSequence</span><span class="p">(</span><span class="n">IOSequence</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_getrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Filename without ending for external and internal date files.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">subseqs</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;For sequence `</span><span class="si">%s</span><span class="s1">` the raw filename cannot &#39;</span>
                                   <span class="s1">&#39;determined.  Either set it manually or &#39;</span>
                                   <span class="s1">&#39;embed the sequence object into the HydPy &#39;</span>
                                   <span class="s1">&#39;framework in the common manner to allow &#39;</span>
                                   <span class="s1">&#39;for an automatic determination.&#39;</span>
                                   <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_delrawfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rawfilename</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rawfilename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getrawfilename</span><span class="p">,</span> <span class="n">_setrawfilename</span><span class="p">,</span> <span class="n">_delrawfilename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pointer</span><span class="o">.</span><span class="n">Double</span><span class="p">(</span><span class="mf">0.</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_getvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Actual value(s) handled by the sequence.  For consistency,</span>
<span class="sd">        `value` and `values` can always be used interchangeably.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">getpointer0d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">NDIM</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">getpointer1d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_setvalues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
    <span class="n">values</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getvalues</span><span class="p">,</span> <span class="n">_setvalues</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">values</span></div>


<div class="viewcode-block" id="Sim"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Sim">[docs]</a><span class="k">class</span> <span class="nc">Sim</span><span class="p">(</span><span class="n">NodeSequence</span><span class="p">):</span>
    <span class="n">NDIM</span><span class="p">,</span> <span class="n">NUMERIC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">NodeSequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ext</span> <span class="o">=</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="Obs"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Obs">[docs]</a><span class="k">class</span> <span class="nc">Obs</span><span class="p">(</span><span class="n">NodeSequence</span><span class="p">):</span>
    <span class="n">NDIM</span><span class="p">,</span> <span class="n">NUMERIC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">NodeSequence</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_ext</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Obs.activate_disk"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Obs.activate_disk">[docs]</a>    <span class="k">def</span> <span class="nf">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">NodeSequence</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">diskflag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;The option `diskflag` of the observation &#39;</span>
                          <span class="s1">&#39;sequence had to be set to `False` due to the &#39;</span>
                          <span class="s1">&#39;following problem: </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">message</span><span class="p">)</span></div>

<div class="viewcode-block" id="Obs.activate_ram"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.Obs.activate_ram">[docs]</a>    <span class="k">def</span> <span class="nf">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">NodeSequence</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
            <span class="n">message</span><span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ramflag</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;The option `ramflag` of the simulation &#39;</span>
                          <span class="s1">&#39;sequence had to be set to `False` due to the &#39;</span>
                          <span class="s1">&#39;following problem: </span><span class="si">%s</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="n">message</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">series_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">memoryflag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">numpy</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">))</span></div>

<div class="viewcode-block" id="NodeSequences"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.NodeSequences">[docs]</a><span class="k">class</span> <span class="nc">NodeSequences</span><span class="p">(</span><span class="n">IOSubSequences</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class for handling node sequences.&quot;&quot;&quot;</span>

    <span class="n">_SEQCLASSES</span> <span class="o">=</span> <span class="p">(</span><span class="n">Sim</span><span class="p">,</span> <span class="n">Obs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqs</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">IOSubSequences</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqs</span><span class="p">,</span> <span class="n">cls_fastaccess</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">seqs</span>

<div class="viewcode-block" id="NodeSequences.loaddata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.NodeSequences.loaddata">[docs]</a>    <span class="k">def</span> <span class="nf">loaddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">loaddata</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="NodeSequences.savedata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.NodeSequences.savedata">[docs]</a>    <span class="k">def</span> <span class="nf">savedata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">savedata</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div></div>



<div class="viewcode-block" id="FastAccess"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess">[docs]</a><span class="k">class</span> <span class="nc">FastAccess</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provides fast access to the values of the sequences of a sequence</span>
<span class="sd">    subgroup and supports the handling of internal data series during</span>
<span class="sd">    simulations.</span>

<span class="sd">    The following details are of relevance for :ref:`HydPy` developers only.</span>

<span class="sd">    :class:`FastAccess` is applied in Python mode only.  In Cython mode,</span>
<span class="sd">    specialized and more efficient cdef classes replace it.  For</span>
<span class="sd">    compatibility with these cdef classes, :class:`FastAccess` objects</span>
<span class="sd">    work with dynamically set instance members.  Suppose there is a</span>
<span class="sd">    sequence named `seq1` which is 2-dimensional, then its associated</span>
<span class="sd">    attributes are:</span>

<span class="sd">      * seq1 (:class:`~numpy.ndarray`): The actual sequence values.</span>
<span class="sd">      * _seq1_ndim (:class:`int`): Number of dimensions.</span>
<span class="sd">      * _seq1_length_0 (:class:`int`): Length in the first dimension.</span>
<span class="sd">      * _seq1_length_1 (:class:`int`): Length in the second dimension.</span>
<span class="sd">      * _seq1_ramflag (:class:`bool`): Handle internal data in RAM?</span>
<span class="sd">      * _seq1_diskflag (:class:`bool`): Handle internal data on disk?</span>
<span class="sd">      * _seq1_path (:class:`str`): Path of the internal data file.</span>
<span class="sd">      * _seq1_file (:class:`file`): Object handling the internal data file.</span>

<span class="sd">    Note that all these dynamical attributes and the following methods are</span>
<span class="sd">    initialised, changed or applied by the respective :class:`SubSequences`</span>
<span class="sd">    and :class:`Sequence` objects.  Handling them directly is error prone</span>
<span class="sd">    and thus not recommended.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FastAccess.openfiles"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess.openfiles">[docs]</a>    <span class="k">def</span> <span class="nf">openfiles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open all files with an activated disk flag.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">):</span>
                <span class="n">path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_path&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">file_</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb+&#39;</span><span class="p">)</span>
                <span class="n">ndim</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ndim&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">position</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="n">idx</span>
                <span class="k">for</span> <span class="n">idim</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">idim</span><span class="p">))</span>
                    <span class="n">position</span> <span class="o">*=</span> <span class="n">length</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">,</span> <span class="n">file_</span><span class="p">)</span></div>

<div class="viewcode-block" id="FastAccess.closefiles"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess.closefiles">[docs]</a>    <span class="k">def</span> <span class="nf">closefiles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close all files with an activated disk flag.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">):</span>
                <span class="n">file_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="FastAccess.loaddata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess.loaddata">[docs]</a>    <span class="k">def</span> <span class="nf">loaddata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load the internal data of all sequences.  Load from file if the</span>
<span class="sd">        corresponding disk flag is activated, otherwise load from RAM.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">ndim</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ndim&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">diskflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">ramflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ramflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">diskflag</span><span class="p">:</span>
                <span class="n">file_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">length_tot</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>
                    <span class="n">length_tot</span> <span class="o">*=</span> <span class="n">length</span>
                    <span class="n">shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
                <span class="n">raw</span> <span class="o">=</span> <span class="n">file_</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">length_tot</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">length_tot</span><span class="o">*</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ndim</span><span class="p">:</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ramflag</span><span class="p">:</span>
                <span class="n">array</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">diskflag</span> <span class="ow">or</span> <span class="n">ramflag</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)[:]</span> <span class="o">=</span> <span class="n">values</span></div>

<div class="viewcode-block" id="FastAccess.savedata"><a class="viewcode-back" href="../../../sequencetools.html#hydpy.core.sequencetools.FastAccess.savedata">[docs]</a>    <span class="k">def</span> <span class="nf">savedata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the internal data of all sequences with an activated flag.</span>
<span class="sd">        Write to file if the corresponding disk flag is activated; store</span>
<span class="sd">        in working memory if the corresponding ram flag is activated.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">actual</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">diskflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_diskflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">ramflag</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ramflag&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">diskflag</span><span class="p">:</span>
                <span class="n">file_</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_file&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">ndim</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_ndim&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">length_tot</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
                    <span class="n">length</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_length_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>
                    <span class="n">length_tot</span> <span class="o">*=</span> <span class="n">length</span>
                <span class="k">if</span> <span class="n">ndim</span><span class="p">:</span>
                    <span class="n">raw</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">length_tot</span><span class="o">*</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">actual</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">raw</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
                <span class="n">file_</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ramflag</span><span class="p">:</span>
                <span class="n">array</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_</span><span class="si">%s</span><span class="s1">_array&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
                <span class="n">array</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">actual</span></div>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iterate over all sequence names.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">key</span></div>

</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 2.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Christoph Tyralla.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>